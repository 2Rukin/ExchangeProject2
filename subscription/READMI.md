<h2>Модуль микро-сервиса по продажи подписки на сервис для пользователей</h2>
<h3>Описание задачи 79 "добавить API создания подписки пользователем"</h3>
Добавить в подписки возможные статусы

“awaiting_transaction” “active” “inactive” “payment_error” "“awaiting_deactivation” “deactivation_error” “awaiting_start_date” “archived”

После создания подписка должна быть в статусе awaiting_transaction

тело запроса

метод /subscriptions post

В запросе будет приходить еще @RequestHeader - x-request-id

пример запроса
![img.png](img.png)
пример успешного ответа , в рамках задачи нужно еще добавить подписке поле is_promo boolean + добавить модель пропоподписки PromoSubscription с полями id promocode(string) type (enum - PROCENT or SUMM )

{

“id”: “54254824”,

“starts_at”: “2021-04-02T13:23:15+00:00”,

“expires_at”: “2022-04-02T13:23:15+00:00”,

“payment_id”: “только после оплаты , пока оплаты не было не возвращать на фронт”,

“email”: “test@rt.ru”,

“pricing_plan”: {

“id”: “123”,

“title”: “Подписка на 1 месяц”,

“period”: {},

“ext_id”: “alpina_1_month”,

“description”: “Каталог электронных и аудиокниг, саммари, видеолекций и подборок по разным темам: личная эффективность и карьерный рост, экономика и бизнес, политика и история, психология и отношения”,

“version”: 1,

“type”: “permanent”

},

“product”: {

“id”: “1”,

“title”: “Описание продукта”

},

“status”: {

“id”: “текущий статус”,

“status_title”: “Описание текущего статуса”

},

“price”: {

“full_price”: 49900,

“price”: 29900,

“promo_price”: 19900

},

“is_promo”: false,

“created_datetime”: “2020-02-01T13:23:15+00:00”,

“updated_datetime”: “2021-02-01T13:34:00+00:00”,

“promocode_info”: {

“is_promocode_applied”: true,

“promocode”: “GAMING2021”

}

}

пример не успешного ответа -

422

{

“title”: “Тариф не существует”,

“message”: “По заданным параметрам не удалось найти тариф для создания подписки”,

“code”: “tariff_not_found”,

“request_id”: “7e055372-15da-4951-8540-a6267555a4f1” -из запроса

}

422

{

“title”: “Не кдалось создать подписку”,

“message”: “По заданным параметрам не удалось создать подписку”,

“code”: “subscription_not_saved”,

“request_id”: “7e055372-15da-4951-8540-a6267555a4f1” -из запроса

}

500

{

“title”: “Не предвиденная ошибка сервера”,

“message”: “Пожалуйста попробуйте позже”,

“code”: “server_error”,

“request_id”: “7e055372-15da-4951-8540-a6267555a4f1” -из запроса

}

Для решение задачи нужно создать новую модель и связи , создать ДТО на входящий запрос + универсальное ДТО для неуспешных ответов на фронт которое собирать в зависимости от результата.

Для тестов добавить в ликвебейз скрипты на заполнение тарифов - сделать 3 тарифа и 1 продукт